datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

generator nestjsDto {
  provider                        = "node -r ts-node/register/transpile-only src/cli.ts"
  output                          = "../src/@generated/nestjs-prisma-gen"
  outputToNestJsResourceStructure = "true"
  flatResourceStructure           = "true"
  exportRelationModifierClasses   = "true"
  reExport                        = "true"
  generateFileTypes               = "all"
  createDtoPrefix                 = "Create"
  updateDtoPrefix                 = "Update"
  dtoSuffix                       = "Dto"
  entityPrefix                    = ""
  entitySuffix                    = "Entity"
  fileNamingStyle                 = "camel"
  classValidation                 = "true"
  noDependencies                  = "false"
  generateEnums                   = "true"
  outputType                      = "class"
  definiteAssignmentAssertion     = "true"
  prettier                        = "true"
  outputApiPropertyType           = "true"
  wrapRelationsAsType             = "false"
  addGraphqlTypes                 = "true"
}

enum CatalogueType {
  LIVE
  TENDERS
  CONTINUOUS
}

enum CataloguePhase {
  PRE_BID
  X_BID
  BOTH
}

type Country {
  id             String
  name           String
  isEuCountry    Boolean @default(false)
  countryCode    String
  vatPrecentage  Int
  timeZoneOffset Int
  phonePrefix    Int
}

type User {
  id          String
  firstName   String
  lastName    String
  email       String?
  companyId   String
  companyName String
}

type UserGroup {
  name        String
  companyId   String
  description String?
  /// users       User[]
}

type Vehicle {
  vehicleId        String
  licensePlate     String
  imageUrl         String
  make             String
  hasVat           Boolean
  model            String
  year             Int
  enginePower      String
  transmissionType String?
  fuelType         String?
  mileage          Float?
  mileageUnit      String?
}

type BidIncrement {
  fixedAmount     Float?
  percentage      Float?
  ruleDescription String?
}

type BidAgent {
  vehicleId String
  userId    String
  user      User
  maxAmount Float
  createdAt DateTime
}

type PreBid {
  bidAmount Float
  bidderId  String
  createdAt DateTime
}

/// model Users {
///   /// @DtoCreateHidden
///   id           String  @id @default(uuid()) @map("_id")
///   firstName    String
///   lastName     String
///   email        String?
///   companyId    String
///   companyName  String
///   isAuctioneer Boolean
/// }

model Catalogues {
  /// @DtoCreateHidden
  /// @DtoUpdateHidden
  id                      String         @id @default(uuid()) @map("_id")
  name                    String
  type                    CatalogueType
  currency                String
  xBidPreparationMinutes  Int
  numberOfAuctionHalls    Int
  expirationToBid         Int
  bidIncrement            BidIncrement
  remarks                 String?
  tnc                     String?
  phases                  CataloguePhase
  sendOverBidNotification Boolean?
  buyerGroups             UserGroup[]
  sellerGroups            UserGroup[]
}

model Lots {
  /// @DtoCreateHidden
  /// @DtoUpdateHidden
  id                  String     @id @default(uuid()) @map("_id")
  catalogueId         String
  country             Country
  index               Int
  bidAgents           BidAgent[]
  description         String?
  startingPrice       Float
  reservePrice        Float?
  sellerCompanyId     String
  auctioneerCompanyId String
  preBids             PreBid[]
  vehicle             Vehicle
}
